import subprocess
import os

def send_to_plink(input_file: str, output_prefix: str, plink_path: str ="plink"):
    """
    Sends a file to PLINK for processing.

    Args:
        input_file (str): Path to the input file for PLINK.
        output_prefix (str): Prefix for the output files generated by PLINK.
        plink_path (str): Path to the PLINK executable (default: "plink").
    """

    if not os.path.exists(input_file):
        raise FileNotFoundError(f"Input file '{input_file}' does not exist.")

    # Construct the PLINK command
    command = [
        plink_path,
        "--file", input_file,
        "--out", output_prefix
    ]

    try:
        # Execute the PLINK command
        result = subprocess.run(command, check=True, text=True, capture_output=True)
        print("PLINK output:")
        print(result.stdout)
    except subprocess.CalledProcessError as e:
        print("Error running PLINK:")
        print(e.stderr)
        raise
    except Exception as e:
        print(f"An unexpected error occurred: {e}")
        raise

if __name__ == "__main__":
    # Example usage
    input_file = "/path/to/input_file"  # Replace with your input file path
    output_prefix = "/path/to/output_prefix"  # Replace with your desired output prefix
    plink_path = "plink"  # Adjust if PLINK is not in your PATH

    try:
        send_to_plink(input_file, output_prefix, plink_path)
    except Exception as e:
        print(f"Failed to send file to PLINK: {e}")